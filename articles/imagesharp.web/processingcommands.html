<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Processing Commands </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Processing Commands ">
    
    
      <link rel="shortcut icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.json">
      <meta property="docfx:tocrel" content="../toc.json">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>

                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../articles/imagesharp/index.html" title="Articles">Articles</a>
                      </li>
                      <li>
                          <a href="../../api/index.html" title="API Documentation">API Documentation</a>
                      </li>
                </ul>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">

                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../imagesharp/index.html" title="ImageSharp" class="">ImageSharp</a>

                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../imagesharp/gettingstarted.html" title="Getting Started" class="">Getting Started</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../imagesharp/pixelformats.html" title="Pixel Formats" class="">Pixel Formats</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp/imageformats.html" title="Image Formats" class="">Image Formats</a>
                                </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../imagesharp/processing.html" title="Processing Images" class="">Processing Images</a>

                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../imagesharp/resize.html" title="Resizing Images" class="">Resizing Images</a>
                                      </li>
                                      <li class="">
                                        <a href="../imagesharp/animatedgif.html" title="Create an animated GIF" class="">Create an animated GIF</a>
                                      </li>
                                    </ul>
                                </li>
                                <li class="">
                                  <a href="../imagesharp/pixelbuffers.html" title="Working with Pixel Buffers" class="">Working with Pixel Buffers</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp/configuration.html" title="Configuration" class="">Configuration</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp/memorymanagement.html" title="Memory Management" class="">Memory Management</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp/security.html" title="Security Considerations" class="">Security Considerations</a>
                                </li>
                              </ul>
                          </li>
                        </ul>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../imagesharp.drawing/index.html" title="ImageSharp.Drawing" class="">ImageSharp.Drawing</a>

                        <ul class="nav level2">
                          <li class="">
                            <a href="../imagesharp.drawing/gettingstarted.html" title="Getting Started" class="">Getting Started</a>
                          </li>
                        </ul>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../imagesharp.web/index.html" title="ImageSharp.Web" class="">ImageSharp.Web</a>

                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../imagesharp.web/gettingstarted.html" title="Getting Started" class="">Getting Started</a>

                              <ul class="nav level3">
                                <li class="active">
                                  <a href="../imagesharp.web/processingcommands.html" title="Processing Commands" class="active">Processing Commands</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp.web/imageproviders.html" title="Image Providers" class="">Image Providers</a>
                                </li>
                                <li class="">
                                  <a href="../imagesharp.web/imagecaches.html" title="Image Caches" class="">Image Caches</a>
                                </li>
                              </ul>
                          </li>
                        </ul>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../fonts/index.html" title="Fonts" class="">Fonts</a>

                        <ul class="nav level2">
                          <li class="">
                            <a href="../fonts/gettingstarted.html" title="Getting Started" class="">Getting Started</a>
                          </li>
                          <li class="">
                            <a href="../fonts/customrendering.html" title="Custom Rendering" class="">Custom Rendering</a>
                          </li>
                        </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="processing-commands">Processing Commands</h1>

<p>The ImageSharp.Web processing API is imperative. This means that the order in which you supply the individual processing operations is the order in which they are compiled and applied. This allows the API to be very flexible, allowing you to combine processes in any order.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It is possible to configure your own processing command pipeline by implementing and registering your own version of the <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.Commands.IRequestParser.html">IRequestParser</a> interface.</p>
</div>
<p>The following processors are built into the middleware. In addition extension points are available to register your own command processors.</p>
<h4 id="resize">Resize</h4>
<p>Allows the resizing of images.</p>
<div class="NOTE">
<h5>Note</h5>
<p>In V3 this processor will automatically correct the order of dimensional commands based on the presence of EXIF metadata indicating rotated (not flipped) images.
This behavior can be turned off per request.</p>
</div>
<pre><code class="lang-bash">{PATH_TO_YOUR_IMAGE}?width=300
{PATH_TO_YOUR_IMAGE}?width=300&amp;height=120&amp;rxy=0.37,0.78
{PATH_TO_YOUR_IMAGE}?width=50&amp;height=50&amp;rsampler=nearest&amp;rmode=stretch
{PATH_TO_YOUR_IMAGE}?width=300&amp;compand=true&amp;orient=false
</code></pre>
<p>Resize commands represent the <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.ResizeOptions.html">ResizeOptions</a> class.</p>
<ul>
<li><code>width</code> The width of the image in px. Use only one dimension to preseve the aspect ratio.</li>
<li><code>height</code> The height of the image in px. Use only one dimension to preseve the aspect ratio.</li>
<li><code>rmode</code> The <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.ResizeMode.html">ResizeMode</a> to use.</li>
<li><code>rsampler</code> The <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.Processors.Transforms.IResampler.html">IResampler</a>
sampler to use.
<ul>
<li><code>bicubic</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Bicubic">Bicubic</a></li>
<li><code>nearest</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_NearestNeighbor">NearestNeighbor</a></li>
<li><code>box</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Box">Box</a></li>
<li><code>mitchell</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_MitchellNetravali">MitchellNetravali</a></li>
<li><code>catmull</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_CatmullRom">CatmullRom</a></li>
<li><code>lanczos2</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Lanczos2">Lanczos2</a></li>
<li><code>lanczos3</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Lanczos3">Lanczos3</a></li>
<li><code>lanczos5</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Lanczos5">Lanczos5</a></li>
<li><code>lanczos8</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Lanczos8">Lanczos8</a></li>
<li><code>welch</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Welch">Welch</a></li>
<li><code>robidoux</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Robidoux">Robidoux</a></li>
<li><code>robidouxsharp</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_RobidouxSharp">RobidouxSharp</a></li>
<li><code>spline</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Spline">Spline</a></li>
<li><code>triangle</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Triangle">Triangle</a></li>
<li><code>hermite</code> <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.KnownResamplers.html#SixLabors_ImageSharp_Processing_KnownResamplers_Hermite">Hermite</a></li>
</ul>
</li>
<li><code>ranchor</code>The <a class="xref" href="../../api/ImageSharp/SixLabors.ImageSharp.Processing.AnchorPositionMode.html">AnchorPositionMode</a> to use.</li>
<li><code>rxy</code> Use an exact anchor position point. The comma-separated x and y values range from 0-1.</li>
<li><code>orient</code> Whether to swap command dimensions based on the presence of EXIF metadata indicating rotated (not flipped) images. Defaults to <code>true</code></li>
<li><code>compand</code> Whether to compress and expand individual pixel colors values to/from a linear color space when processing. Defaults to <code>false</code></li>
</ul>
<h4 id="format">Format</h4>
<p>Allows the encoding of the output image to a new image format. The available formats depend on your configuration settings.</p>
<pre><code>{PATH_TO_YOUR_IMAGE}?format=bmp
{PATH_TO_YOUR_IMAGE}?format=gif
{PATH_TO_YOUR_IMAGE}?format=jpg
{PATH_TO_YOUR_IMAGE}?format=pbm
{PATH_TO_YOUR_IMAGE}?format=png
{PATH_TO_YOUR_IMAGE}?format=tga
{PATH_TO_YOUR_IMAGE}?format=tiff
{PATH_TO_YOUR_IMAGE}?format=webp
</code></pre>
<h4 id="quality">Quality</h4>
<p>Allows the encoding of the output image at the given quality.</p>
<ul>
<li>For Jpeg this ranges from 1—100.</li>
<li>For WebP this ranges from 1—100.</li>
</ul>
<pre><code>{PATH_TO_YOUR_IMAGE}?quality=90
{PATH_TO_YOUR_IMAGE}?format=jpg&amp;quality=42
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Only certain formats support adjustable quality. This is a constraint of individual image standards not the API.</p>
</div>
<h4 id="background-color">Background Color</h4>
<p>Allows the changing of the background color of transparent images.</p>
<pre><code>{PATH_TO_YOUR_IMAGE}?bgcolor=FFFF00
{PATH_TO_YOUR_IMAGE}?bgcolor=C1FF0080
{PATH_TO_YOUR_IMAGE}?bgcolor=red
{PATH_TO_YOUR_IMAGE}?bgcolor=128,64,32
{PATH_TO_YOUR_IMAGE}?bgcolor=128,64,32,16
</code></pre>
<h2 id="securing-processing-commands">Securing Processing Commands</h2>
<p>With ImageSharp.Web it is possible to configure an action to generate an HMAC by setting the <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.Middleware.ImageSharpMiddlewareOptions.html#SixLabors_ImageSharp_Web_Middleware_ImageSharpMiddlewareOptions_HMACSecretKey">HMACSecretKey</a> property to any byte array value. This triggers checks in the middleware to look for and compare a HMAC hash of the request URL with the hash that is passed alongside the commands.</p>
<p>In cryptography, an HMAC (sometimes expanded as either keyed-hash message authentication code or hash-based message authentication code) is a specific type of message authentication code (MAC) involving a cryptographic hash function and a secret cryptographic key. As with any MAC, it may be used to simultaneously verify both the data integrity and authenticity of a message.</p>
<p>HMAC can provide authentication using a shared secret instead of using digital signatures with asymmetric cryptography. It trades off the need for a complex public key infrastructure by delegating the key exchange to the communicating parties, who are responsible for establishing and using a trusted channel to agree on the key prior to communication.</p>
<p>Any cryptographic hash function, such as SHA-2 or SHA-3, may be used in the calculation of an HMAC; the resulting MAC algorithm is termed HMAC-X, where X is the hash function used (e.g. HMAC-SHA256 or HMAC-SHA3-512). The cryptographic strength of the HMAC depends upon the cryptographic strength of the underlying hash function, the size of its hash output, and the size and quality of the key.</p>
<p>HMAC does not encrypt the message. Instead, the message (encrypted or not) must be sent alongside the HMAC hash. Parties with the secret key will hash the message again themselves, and if it is authentic, the received and computed hashes will match.</p>
<p>By default ImageSharp.Web will use a HMAC-SHA256 algorithm.</p>
<pre><code class="lang-c#">private Func&lt;ImageCommandContext, byte[], Task&lt;string&gt;&gt; onComputeHMACAsync = (context, secret) =&gt;
{
    string uri = CaseHandlingUriBuilder.BuildRelative(
            CaseHandlingUriBuilder.CaseHandling.LowerInvariant,
            context.Context.Request.PathBase,
            context.Context.Request.Path,
            QueryString.Create(context.Commands));

    return Task.FromResult(HMACUtilities.ComputeHMACSHA256(uri, secret));
};
</code></pre>
<p>Users can replicate that key using the same <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.CaseHandlingUriBuilder.html">CaseHandlingUriBuilder</a> and <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.HMACUtilities.html">HMACUtilities</a> APIs to generate the HMAC hash on the client. The hash must be passed via a command using the <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.HMACUtilities.html#SixLabors_ImageSharp_Web_HMACUtilities_TokenCommand">TokenCommand</a> constant.</p>
<p>Any invalid matches are rejected at the very start of the processing pipeline with a 400 HttpResponse code.</p>
<h2 id="imagetaghelper">ImageTagHelper</h2>
<p>ASP.NET tag helpers are useful because they provide a more natural syntax for creating HTML elements in server-side code. They allow developers to create HTML elements in a way that is similar to how they would write HTML markup in a Razor view.</p>
<p>Some of the benefits of using tag helpers include:</p>
<ol>
<li>Improved readability: Tag helpers make it easier to understand the purpose of the code by providing a clear and concise syntax that is closer to HTML.</li>
<li>Reduced complexity: Tag helpers simplify the creation of complex HTML elements by reducing the amount of boilerplate code needed.</li>
<li>Type safety: Tag helpers are strongly typed, which means that the compiler can catch errors at compile time rather than at runtime.</li>
<li>Testability: Tag helpers make it easier to unit test server-side code by providing a cleaner separation of concerns between the server-side code and the HTML markup.</li>
<li>Code reuse: Tag helpers can be used to encapsulate commonly used HTML elements, making it easier to reuse code across multiple views and pages.</li>
</ol>
<p>Overall, ASP.NET tag helpers provide a more efficient and maintainable way to create HTML elements in server-side code.</p>
<p>ImageSharp.Web v3.0.0 comes equipped with a custom tag helper that allows the generation of all the commands supported by the middleware in an easily accessible manner. This includes automatic generation of HMAC command tokens.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Using <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.TagHelpers.ImageTagHelper.html">ImageTagHelper</a> is the recommended way to generate processing commands.</p>
</div>
<p>To use <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.TagHelpers.ImageTagHelper.html">ImageTagHelper</a>, add the following <code>using</code> and <code>addTagHelper</code> commands to <code>_ViewImports.cshtml</code> in your project.</p>
<pre><code class="lang-html">@using SixLabors.ImageSharp
@using SixLabors.ImageSharp.Processing
@using SixLabors.ImageSharp.Web

@addTagHelper *, SixLabors.ImageSharp.Web
</code></pre>
<p>All ImageSharp.Web commands are strongly typed and prefixed with <code>imagesharp</code> to namespace them against potentially conflicting commands. Visual Studio intellisense with automatically provide guidance
once you start typing. For example, the following markup...</p>
<pre><code class="lang-html">&lt;img
    src=&quot;sixlabors.imagesharp.web.png&quot;
    imagesharp-width=&quot;300&quot;
    imagesharp-height=&quot;200&quot;
    imagesharp-rmode=&quot;ResizeMode.Pad&quot;
    imagesharp-rcolor=&quot;Color.LimeGreen&quot; /&gt;
</code></pre>
<p>Will generate the following command when HMAC is enabled.</p>
<pre><code class="lang-bash">/sixlabors.imagesharp.web.png?width=300&amp;height=200&amp;rmode=Pad&amp;rcolor=32CD32FF&amp;hmac=21f93e41021df0d3f88b5e2a8753bb273f292598e1511df67ec7cfb63f0b2994
</code></pre>
<p>The <a class="xref" href="../../api/ImageSharp.Web/SixLabors.ImageSharp.Web.TagHelpers.ImageTagHelper.html">ImageTagHelper</a> type is unsealed so that you can inherit the type and support your own custom commands.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/SixLabors/docs/blob/main/articles/imagesharp.web/processingcommands.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
